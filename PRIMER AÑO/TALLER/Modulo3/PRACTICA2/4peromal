programa ej3p2
procesos
  proceso juntarFlores(ES cant:numero)
  comenzar
    mientras(HayFlorEnLaEsquina)
      tomarFlor
      cant:=cant+1
  fin
  proceso juntarPapeles(ES cant:numero)
  comenzar
    mientras(HayPapelEnLaEsquina)
      tomarPapel
      cant:=cant+1
  fin
  proceso limpiarEsquina(E avIni:numero;E calleIni:numero; ES cant:numero)
  variables
    av:numero
    calle:numero
  comenzar
    Random(av,25,75)
    Random(calle,25,75)
    Pos(av,calle)
    juntarFlores(cant)
    juntarPapeles(cant)
    Pos(avIni,calleIni)
  fin
  proceso asignarRobot
  comenzar
    EnviarMensaje(1,r1)
    EnviarMensaje(2,r2)
    EnviarMensaje(3,r3)
    EnviarMensaje(4,r4)
  fin
  proceso enviar(E valor:boolean;E n:numero)
  comenzar
    si(n = 1)
      EnviarMensaje(valor,r1)
    sino
      si(n=2)
        EnviarMensaje(valor,r2)
      sino
        si(n=3)
          EnviarMensaje(valor,r3)
        sino
          EnviarMensaje(valor,r4)
  fin
  proceso recibirCantidad(ES n:numero)
  comenzar
    si(n = 1)
      RecibirMensaje(n,r1)
    sino
      si(n=2)
        RecibirMensaje(n,r2)
      sino
        si(n=3)
          RecibirMensaje(n,r3)
        sino
          RecibirMensaje(n,r4)
  fin
  proceso finalizo
  comenzar
    EnviarMensaje(F,r1)
    EnviarMensaje(F,r2)
    EnviarMensaje(F,r3)
    EnviarMensaje(F,r4)
  fin
  proceso calcularMax(ES maxRobot:numero)
  variables
    nuevoRobot:numero
    cantNueva:numero
    cantMax:numero
  comenzar
    cantMax:=-1
    repetir 4
      RecibirMensaje(nuevoRobot,*)
      recibirCantidad(cantNueva)
      si(cantMax < cantNueva)
        cantMax:= cantNueva
        maxRobot:=nuevoRobot
  fin
areas
  areaF:AreaP(1,1,1,1)
  area1:AreaP(25,1,25,1)
  area2:AreaP(30,1,30,1)
  area3:AreaP(35,1,35,1)
  area4:AreaP(40,1,40,1)
  areaParcial:AreaPC(25,25,75,75)
robots
  robot fiscal
  variables
    ale:numero
    id:numero
    termino:boolean
    maxRobot:numero
  comenzar
    asignarRobot
    repetir 10
      Random(ale,1,4)
      enviar(V,ale)
      RecibirMensaje(termino,*)
    finalizo
    calcularMax(maxRobot)
    id:=1
    repetir 4
      si(id = maxRobot)
        enviar(V,id)
      sino
        enviar(F,id)
      id:=id+1
  fin
  robot recolector
  variables
    cant:numero
    sigue:boolean
    ganador:boolean
    id:numero
  comenzar
    RecibirMensaje(id,rf)
    cant:=0
    RecibirMensaje(sigue,rf)
    mientras(sigue)
      limpiarEsquina(PosAv,PosCa,cant)
      EnviarMensaje(V,rf)
      RecibirMensaje(sigue,rf)
    EnviarMensaje(id,rf)
    EnviarMensaje(cant,rf)
    RecibirMensaje(ganador,rf)
    si(ganador)
      Pos(50,50)   
  fin
variables
  r1: recolector
  r2: recolector
  r3: recolector
  r4: recolector
  rf: fiscal
comenzar
  AsignarArea(rf,areaF)
  AsignarArea(r1,area1)
  AsignarArea(r2,area2)
  AsignarArea(r3,area3)
  AsignarArea(r4,area4)
  AsignarArea(r1,areaParcial)
  AsignarArea(r2,areaParcial)
  AsignarArea(r3,areaParcial)
  AsignarArea(r4,areaParcial)
  Iniciar(rf,1,1)
  Iniciar(r1,25,1)
  Iniciar(r2,30,1)
  Iniciar(r3,35,1)
  Iniciar(r4,40,1)
fin